<template>
  <require from="./soundcloudplayer.css"></require>
  <require from="../value-converters/tracktimeformat"></require>
  <div class="card">
    <div if.bind="selectedTrack" class="card-block">
      <div class="d-flex w-100 justify-content-between align-items-center mb-3">
        <button if.bind="!selectedTrack.isPlaying" role="button" type="button" class="btn btn-lg btn-primary" click.delegate="playTrack(selectedTrack, false)"><i class="fa fa-play" aria-hidden="true"></i></button>
        <button if.bind="selectedTrack.isPlaying" role="button" type="button" class="btn btn-lg btn-primary" click.delegate="pauseTrack(selectedTrack)"><i class="fa fa-pause" aria-hidden="true"></i></button>
        <div class="text-center">
          ${selectedTrack.title}<br>
          <small class="text-muted">by ${selectedTrack.user.username}</small>
        </div>
        <div>
          <div class="prev-next-buttons text-center">
            <button role="button" class="btn btn-link"><i class="fa fa-step-backward" aria-hidden="true" click.delegate="previousTrack()"></i></button>
            <button role="button" class="btn btn-link"><i class="fa fa-step-forward" aria-hidden="true" click.delegate="nextTrack()"></i></button>
          </div>
          <div class="text-center">
            <small class="text-muted">${trackTime | trackTimeFormat } / ${selectedTrack.duration | trackTimeFormat}</small>
          </div>
        </div>
      </div>
      <div class="playlist-track-progress progress">
        <div class="progress-bar ${selectedTrack.isLoading ? ' progress-bar-striped progress-bar-animated' : ''}" role="progressbar"
          aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style.bind="!selectedTrack.isLoading ? 'width:' + (trackTime/selectedTrack.duration)*100 +'%' : 'width:100%'">${selectedTrack.isLoading ? 'Loading Track ...' : ''}</div>
    </div>
  </div>
  <ul class="playlist-track-list list-group list-group-flush">
    <li role="button" class="list-group-item list-group-item-action ${track === selectedTrack && !track.isPlaying ? 'paused' : ''} ${track.isPlaying ? 'playing' : ''}"
      repeat.for="track of playlist.tracks" click.delegate="track.isPlaying ? pauseTrack(track) : playTrack(track, track !== selectedTrack)">
      ${track.title}
      </li>
  </ul>
  </div>
</template>